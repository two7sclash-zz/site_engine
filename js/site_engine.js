function ConstantValues(){this.NL="\r\n"}function ErrorHandler(){function e(e){this.message+=constants.NL+e,"none"==this.type&&(this.type="nonfatal"),this.type="fatal"}function t(){this.message="",this.type="none"}function s(){if("fatal"==this.type&&alert(this.message),"none"!=this.type)throw this.message;this.clear}this.message="",this.type="none",this.update=e,this.clear=t,this.show=s}function AllSites(){function e(){var e=[];for(var t in this.values[0])e.push(t);return e}function t(e){for(var t=0;t<this.values.length;t++)if(e==this.values[t].isbn)return this.values[t]}function s(){globalData={};for(var e=0,t="";e<this.siteObjectNames.length;e++)t=this.siteObjectNames[e],globalData[t]={},copyToObject(this[t],globalData[t]);return globalData}function i(e,t){for(var s,i=0;i<this.values.length;i++)if(e==this.values[i].isbn)return;s=new r(e,t),this.values.push(s)}function a(){for(var e=[],t=0;t<this.values.length;t++)e.push(this.values[t].isbn);return e}function n(){for(var e=[],t=0;t<this.values.length;t++)e.push(this.values[t].dir);return e}function r(e,t){this.isbn=e,this.dir=t}function o(){for(var e={},t="",s=0,i=c.length;i>s;s++)t=makePath([this.engineDirs.templates],c[s]+".html"),$.ajax({url:t,async:!1,success:function(t){e[c[s]]=t},error:function(){alert("Couldn't load asset template file "+t)}});return e}var c=["index","video","video_playlist","audio","audio_playlist","vpg_ebook","cl_ebook","timeline","crossword","flash","google_earth","google_maps","itunes_playlist","author_blog","news_now","speak_up","download","flashcards_printable","coming_soon"];this.disciplines={Accounting:["400","South-Western",""],Anthropology:["15","Wadsworth",""],Art:["37","Wadsworth",""],Astronomy:["","Brooks/Cole",""],Biology:["22","Brooks/Cole",""],Business:["","South-Western",""],"Business Law":["404","South-Western","blaw"],Chemistry:["12","Brooks/Cole",""],"College Success":["26","Wadsworth","collegesuccess"],Communication:["48","Wadsworth",""],Counseling:["","Brooks/Cole",""],"Criminal Justice":["23","Wadsworth","criminaljustice"],"Decision Sciences":["412","South-Western","decisionsciences"],"Earth Science":["30","Brooks/Cole","earthscience"],Economics:["413","South-Western",""],Education:["3","Wadsworth",""],English:["300","Wadsworth",""],Finance:["414","South-Western",""],French:["304","Heinle",""],Geology:["","Brooks/Cole",""],German:["305","Heinle",""],History:["21","Wadsworth",""],Humanities:["","Wadsworth",""],Italian:["306","Heinle",""],Japanese:["309","Heinle",""],Management:["","South-Western",""],Marketing:["415","South-Western",""],Mathematics:["1","Brooks/Cole",""],Music:["2","Wadsworth",""],Philosophy:["2","Wadsworth",""],"Political Science":["20","Wadsworth","polisci"],Psychology:["24","Wadsworth",""],Physics:["","Brooks/Cole",""],"Social Work":["4","Brooks/Cole","social_work"],Sociology:["14","Wadsworth",""],Spanish:["303","Heinle",""],Statistics:["17","Brooks/Cole",""],Testing:["","Wadsworth",""],Theatre:["51","Wadsworth",""]},this.subbrands={"Brooks/Cole":["brookscole_logo","brookscole"],Heinle:["cengageLearning_v3","heinle"],"South-Western":["soutWestern","southwestern"],Wadsworth:["Wadsorth_logo","wadsworth"]},this.ilrnHostname="webquiz.ilrn.com",this.siteObjectNames=["engineDirs","engineFiles","siteDirs","siteFiles","assetDirs","assetFiles","glossary","labels"],this.engineDirs={root:"",templates:"templates",js:"js",css:"css",images:"images",icons:"icons",logos:"/images/header_logos",fae:"/flash/central_app"},this.engineFiles={root:"",shellTemplate:"",stylesheet:"",reportStylesheet:"[%engineDirs.css%]/report.css",glossary:"[%engineDirs.js%]/glossary.js",login:"[%engineDirs.templates%]/login.html",login4ltr:"[%engineDirs.templates%]/4ltr/login.html",leftPanel:"[%engineDirs.templates%]/left_panel.html",siteDefinition:"site_definition.xml",jwPlayer:"/shared/jw_player/player.swf"},this.siteDirs={root:"",images:"images",content:"","protected":"student",unprotected:"assets",courseware:"courseware",glossaryAudio:"glossary/audio/"},this.siteFiles={root:"",stylesheet:"styles.css",standaloneStyles:"",stylesheet4ltr:"site.css",homePageImage:"[%siteDirs.images%]/home_page.jpg",homePageBaseFilename:"home",glossaryContent:"glossary/glossary_content.js",authentication:"[%siteDirs.protected%]/index.html",ssoUrls:"[%siteDirs.protected%]/sso_urls.jsp",ebookUrl:"",ebookDomain:"",instructorSite:"",survey:"http://cengage.qualtrics.com/SE?SID=SV_0GwLkyEppF8MqI4&SVID=Prod",buyOnline:"http://www.cengagebrain.com/tl1/en/US/storefront/ichapters?cmd=catProductDetail&ISBN="},this.assetDirs={root:"",downloads:"",media:"",captions:"",transcripts:"",faeData:"data"},this.assetFiles={root:""},this.glossary={audio:!1,chapterTitles:!1},this.labels={chapterSingular:"Chapter",chapterPlural:"Chapters",resourceGroupSingular:"Course",resourceGroupPlural:"Courses"};for(var l=0,u={};l<this.siteObjectNames.length;l++){u=this[this.siteObjectNames[l]];for(var h in u)u[h]=replaceVars(u[h],this)}this.loginPattern=/name\="loginForm".+?\/sso\/dologin.do/i,this.notFoundPattern=/<title>Cengage Learning \- Learning solutions, training and educational publishing<\/title>/,this.values=[],this.filter="all",this.templates=o.call(this),this.properties=e,this.get=t,this.getGlobalData=s,this.add=i,this.isbns=a,this.dirs=n}function Site(){function e(){copyToObject(allSites.getGlobalData(),this),currentSiteData=allSites.get(currentLocation.isbn),this.isbn=currentSiteData.isbn,this.siteDirs.root=currentSiteData.dir,this.siteFiles.root=this.siteDirs.root,this.defaultIframeHeight=allSites.defaultIframeHeight}function t(){for(var e=["1st","2nd","3rd","4th","5th","6th","7th","8th","9th","10th","11th","12th","13th","14th","15th","16th","17th","18th","19th","20th"],t=0,s="",i="",a="";t<allSites.siteObjectNames.length;t++){s=allSites.siteObjectNames[t];for(var n in this[s])i=this[s][n],a=getUrlType(i),"."==i&&(i=""),"root"==n||!this[s][n]||"relative to site"!=a&&"none"!=a||(this[s][n]=makePath([this[s].root],i))}this.type||(this.type="premium"),this.engineFiles.shellTemplate="shell_"+this.type+".html",this.engineFiles.stylesheet=makePath([this.engineDirs.css],this.type+".css"),"resource_center"==site.type?-1==this.engineDirs.icons.indexOf("premium")&&(this.engineDirs.icons=makePath([this.engineDirs.icons],"premium")):this.engineDirs.icons=makePath([this.engineDirs.icons],this.type),this.editionType&&(this.edition+=this.editionType+" "),this.edition=e[parseInt(this.editionNumber,10)-1]+" Edition",this.chapterCount=this.chapterTitles.length,this.updateChaptersFree(),0===this.demoChapters.length&&"demo"==currentLocation.parameter&&(this.demoChapters=this.demoChapters.concat(this.chaptersFree),this.forceDemo=!0),this.demoChapters.length>0?(this.firstChapter=this.demoChapters[0],this.lastChapter=this.demoChapters[this.demoChapters.length-1]):(this.firstChapter=this.startChapterNumber.toString(),this.lastChapter=(this.startChapterNumber-1+this.chapterCount).toString())}function s(){var e=[],t=assets.names();if(!(this.chaptersFree.length>0)){for(var s=0,i=t.length;i>s;s++){e=assets.get(t[s]).chaptersFree;for(var a=0,n="";a<e.length;a++)n=e[a],-1==$.inArray(n,this.chaptersFree)&&this.chaptersFree.push(n)}this.chaptersFree.sort(numerical)}}function i(e,t){var s="";return"resource_center"==site.type&&(s+="/"),s+="/"+e,t&&(s+="/"+t),s}this.type="",this.chapterTitles=[],this.chapterCount=0,this.demoChapters=[],this.forceDemo=!1,this.chaptersFree=[],this.startChapterNumber=1,this.firstChapter="",this.lastChapter="",this.showHeading=!1,this.showChapterNumbers=!0,this.menuStyle="normal",this.unavailableMenuOptions="show",this.discipline="",this.isbnCore="",this.isbn="",this.ebookIsbn="",this.showBook="",this.title="",this.subtitle="",this.bookId="",this.author="",this.authorShort="",this.editionNumber="",this.editionType="",this.edition="",this.bookcoverImage="",this.assetMargin="",this.getAllSitesData=e,this.update=t,this.updateChaptersFree=s,this.makeLocationId=i}function Buckets(){function e(e){if(this.name="",this.title="",this.blurbShort="",this.blurbLong="",this.icon="",this["interface"]="",this.assets=[],"undefined"!=typeof e){for(var t in e)this[t]="undefined"==typeof e[t]?"":e[t];this["interface"]||(this["interface"]="navBar"==this.name?"navBar":"menu")}}function t(){return new e}function s(e){return 0===arguments.length&&(e=this.filter),a("name",e,this.values)}function i(e){return 0===arguments.length&&(e=this.filter),a("title",e,this.values)}function a(e,t,s){for(var i=new Array,a=0;a<s.length;a++)switch(t){case"all":i.push(s[a][e]);break;case"navBar":"navBar"==s[a]["interface"]&&i.push(s[a][e]);break;case"menu":"menu"==s[a]["interface"]&&i.push(s[a][e])}return i}function n(){var e=new Array;for(var t in this.values[0])e.push(t);return e}function r(e){for(var t=0;t<this.values.length;t++)if(e==this.values[t].name)return this.values[t]}function o(e){for(var t=0;t<this.values.length;t++)if(e==this.values[t].title)return this.values[t]}function c(e){for(var t=null,s=this.names("menu"),i=0;i<s.length;i++)s[i]==e&&(t=i);return t}function l(t){var s;s=new e(t),this.values.push(s)}function u(){for(var e=[],t=0,s=this.values.length,i="";s>t;t++){i=this.values[t].name,e=assets.getByBucket(i);for(var a=0,n=e.length,r="";n>a;a++)r=e[a].name,this.values[t].assets.push(r)}}this.values=[],this.filter="all",this.bucketObj=t,this.names=s,this.titles=i,this.properties=n,this.get=r,this.getByTitle=o,this.getIndex=c,this.add=l,this.update=u,this.values.push(new e({name:"_none","interface":"menu"})),this.values.push(new e({name:"navBar",title:"Top Navigation Bar"}))}function Assets(){function e(e,t){var s=0;if(this.name="",this.title="",this["interface"]="",this.bucket="",this.type="",this.scope="",this.blurb="",this.heading="",this.showHeading=!1,this.instructions="",this["protected"]=!1,this.standaloneProtected=!0,this.courseware=!1,this.url="",this.dir="",this.template="",this.chaptersFree=[],this.chaptersUnavailable=[],this.iframeHeight="",this.menuTabLabel="Menu",this.contentTabLabel="Content",this.linkTitle="",this.linkBullet="",this.icon="",this.linkStyle="",this.windowWidth="",this.windowHeight="",this.playerWidth="",this.playerHeight="",this.margin="",this.sectionsFile="",this.sectionsUrl="",this.sections=[],this.mediaOptions={videoWidth:"",videoHeight:"",downloadMedia:!0,downloadMediaExt:"zip",downloadMediaLabel:"",viewTranscript:!1,downloadTranscript:!1,downloadTranscriptExt:"doc",streamer:""},this.chaptersAvailable=[],this.behavior="","undefined"!=typeof e||"undefined"!=typeof t){this.showHeading=t.site.showHeading;for(var i in e)this[i]="undefined"==typeof e[i]?"":e[i];switch(this.template){case"ebook":this.template="vpg_ebook";break;case"4ltr/flashcards":this.template="flashcards_printable";break;case"4ltr/download":this.template="download",this.linkTitle="Access Resource"}this.bucket||(this.bucket="_none"),"_none"!=this.bucket&&(this.heading+=buckets.get(this.bucket).title+": "),this.heading+=this.title,"flash"!=this.template&&"download"!=this.template||this.linkTitle||(this.linkTitle="Access the "+this.title+" for This Chapter"),this.assetType=getHostname(this.url)==allSites.ilrnHostname?"ilrn":e.type,delete this.type,this.behavior="menu"==buckets.get(this.bucket)["interface"]?"embedded":"popup",this.sectionsFile&&(this.sectionsUrl=makePath([t.site.siteDirs.root],this.sectionsFile)),this.mediaOptions.downloadMediaLabel||("video"==this.type?this.mediaOptions.downloadMediaLabel="Zipped MP4":"audio"==this.type&&(this.mediaOptions.downloadMediaLabel="Zipped MP3")),s=t.site.demoChapters.length>0?t.site.demoChapters.length:t.site.chapterTitles.length;for(var a=0,n=0;s>a;a++)n=t.site.demoChapters.length>0?t.site.demoChapters[a]:(a+t.site.startChapterNumber).toString(),-1==$.inArray(n,this.chaptersUnavailable)&&this.chaptersAvailable.push(n)}}function t(){return new e}function s(){return{chapter:"",url:"",name:"",title:""}}function i(e){return 0===arguments.length&&(e=this.filter),n("name",e,this.values)}function a(e){return 0===arguments.length&&(e=this.filter),n("title",e,this.values)}function n(e,t,s){for(var i=new Array,a=0;a<s.length;a++)switch(t){case"all":i.push(s[a][e]);break;case"navBar":"navBar"==buckets.get(s[a].bucket)["interface"]&&i.push(s[a][e]);break;case"menu":"navBar"!=buckets.get(s[a].bucket)["interface"]&&i.push(s[a][e])}return i}function r(){var e=new Array;for(var t in this.values[0])e.push(t);return e}function o(e){for(var t=0;t<this.values.length;t++)if(e==this.values[t].name)return this.values[t]}function c(e){for(var t=0;t<this.values.length;t++)if(e==this.values[t].title)return this.values[t]}function l(e){for(var t=0,s=[];t<this.values.length;t++)e==this.values[t].bucket&&s.push(this.values[t]);return s}function u(e){for(var t=null,s=this.names("menu"),i=0;i<s.length;i++)s[i]==e&&(t=i);return t}function h(e){for(var t=this.get(e).bucket,s=-1,i=this.getByBucket(t),a=0,n=i.length;n>a;a++)if(e==i[a].name){s=a;break}return s}function p(t,s){var i;i=new e(t,s),this.values.push(i)}this.values=[],this.filter="all",this.assetObj=t,this.sectionObj=s,this.names=i,this.titles=a,this.properties=r,this.get=o,this.getByTitle=c,this.getByBucket=l,this.getIndex=u,this.getBucketIndex=h,this.add=p}function ResourceCenter(){function e(e){var t={};return"undefined"!=typeof e&&(t=e),t.site=$.extend(!0,{},site),t.assets=new Assets,t.buckets=new Buckets,t.name="",t.icon="",t.glossaryContent=[],t}function t(e){return 0===arguments.length&&(e=this.filter),n("name",e,this.values)}function s(e){return 0===arguments.length&&(e=this.filter),n("title",e,this.values)}function i(e){for(var t=0;t<this.values.length;t++)if(e==this.values[t].name)return this.values[t]}function a(e){return this.values[e]}function n(e,t,s){for(var i=new Array,a=0;a<s.length;a++)switch(t){case"all":i.push(s[a][e])}return i}function r(e){site=$.extend(site,this.get(e).site),site.update(),assets=$.extend(!0,assets,this.get(e).assets),buckets=$.extend(!0,buckets,this.get(e).buckets),glossary.content=this.get(e).glossaryContent}function o(e){this.values.push(e),this.count=this.values.length,this.values[this.count-1].site.update()}function c(e,t){this.values[e].glossaryContent=this.values[e].glossaryContent.concat(t)}function l(e){for(var t=null,s=this.names(),i=0;i<s.length;i++)s[i]==e&&(t=i);return t}this.values=[],this.filter="all",this.count=0,this.resourceGroup=e,this.names=t,this.titles=s,this.get=i,this.getByIndex=a,this.load=r,this.add=o,this.updateGlossary=c,this.getIndex=l}function Status(){function e(){for(var e=0,t=this.tabLoaded.length;t>e;e++)this.tabLoaded[e]=!1}function t(){"asset"==currentLocation.type&&(this.asset=currentLocation.name),"resource_center"==site.type&&(this.resourceGroup=currentLocation.resourceGroup,this.isNewResourceGroup=this.resourceGroup!=this.previousResourceGroup?!0:!1,this.previousResourceGroup=this.resourceGroup,this.isNewResourceGroup&&(this.chapter="",this.asset="")),currentLocation.chapter&&(this.chapter=currentLocation.chapter),this.chapter!=this.previousChapter?(this.isNewChapter=!0,this.resetTabStatus()):this.isNewChapter=!1,this.previousChapter=this.chapter}function s(e){this.chapterView!=e&&(this.chapterView=e,this.resetTabStatus())}function i(){var e=!1,t="<!-- AUTHENTICATION CHECK - DO NOT REMOVE OR ALTER THIS COMMENT -->";$.ajax({url:site.siteFiles.authentication,async:!1,success:function(s){-1!=s.indexOf(t)&&(e=!0)}}),this.authenticated=e}var a="";switch(this.shell,this.chapterMenu=0,this.chapter="",this.previousChapter="",this.isNewChapter=!1,this.chapterView="single",this.sideMenuInd=0,this.asset="",this.resourceGroup="",this.previousResourceGroup="",this.isNewResourceGroup=!1,this.browser="",this.tabLoaded=[],this.tabContent="",this.authenticated=!1,this.token="",this.hostname=window.location.hostname,this.server="",$.each($.browser,function(e,t){t&&(a=e)}),this.browser=a,this.hostname){case"coldevss2":this.server="development_1";break;case"d-college.cengage.com":this.server="development_2";break;case"s-college.cengage.com":this.server="staging";break;case"college.cengage.com":this.server="production"}this.resetTabStatus=e,this.update=t,this.updateChapterView=s,this.checkAuthentication=i}function ContentLocation(e){function t(){this.isbn="",this.parameter="",this.type="",this.behavior="",this.name="",this.title="",this.menuName="",this.bucket="",this.bucketInd=0,this.assetType="",this.chapter="",this.chapterTitle="",this.resourceGroup="",this.id="",this.template="",this.templateStr="",this.playlist=!1,this.assetProtected=!1,this.available=!0,this.extension="",this.urlNoExtension="",this.helpLink=""}function s(s,a){var o=new t,l=[],u=[],h="",p=getLocationId(s),d="",m="";if(null!=(l=p.match(/^([^\:]+)\:([^\:]+)$/))&&(o.parameter=l[2],p=l[1]),null!=(l=p.match(/^((?:\d{9}[\dxX]|\d{13})(?:_demo)?)(\/(.*))?/))?(o.isbn=l[1],p=l[2],p||(p="")):site.isbn?o.isbn=site.isbn:(o.isbn="",o.type="all sites"),null!=(l=p.match(/\/([^\/]+)?/g))){for(var f=0;f<l.length;f++)l[f]=l[f].replace("/","");"resource_center"!=site.type?(l[0]&&(o.name=l[0]),l[1]&&(o.chapter=l[1])):(l[0]&&(o.resourceGroup=l[0]),l[1]&&(o.name=l[1]),l[2]&&(o.chapter=l[2]))}if(currentStatus.shell||(currentStatus.shell="shell"==o.parameter||"demo"==o.parameter||1==site.forceDemo||"home"==o.name||!p&&o.isbn?!0:!1),assets.names().length>0){if("resource_center"==site.type&&o.resourceGroup&&resourceCenter.load(o.resourceGroup),o.chapter&&!o.name&&("chapterMenu"==a||"resourceGroupSubmenu"==a)&&(o.name=currentStatus.asset?currentStatus.asset:c(o.chapter),o.type="asset"),"resource_center"==site.type&&o.name&&!o.resourceGroup&&(o.resourceGroup=currentStatus.resourceGroup),"report"==o.parameter?o.type="report":o.resourceGroup&&!o.name?o.type="resource group":p&&"home"!=o.name?"asset"==getContentType(o.name)?o.type="asset":"bucket"==getContentType(o.name)?o.type="bucket":(h=i(o.name),h?(o.name=h,o.type="asset"):o.type="error"):(o.name="home",o.title="Home Page",o.type="home",o.scope="book"),"asset"!=o.type&&"bucket"!=o.type||o.chapter||(o.chapter=currentStatus.chapter?currentStatus.chapter:site.firstChapter),"bucket"==o.type)if(o.bucket=o.name,o.menuName=o.bucket,o.bucketInd=0,o.type="asset",o.chapter){for(var f=0,u=buckets.get(o.bucket).assets,g=u.length;g>f;f++)if(-1==$.inArray(o.chapter,assets.get(u[f]).chaptersUnavailable)){o.name=u[f];break}}else o.name=buckets.get(o.bucket).assets[0];if("asset"==o.type){if(copyToObject(assets.get(o.name),o),"hide"!=site.unavailableMenuOptions&&"gray"!=site.unavailableMenuOptions||o.bucket&&"_none"!=o.bucket||-1!=$.inArray(o.chapter,assets.get(o.name).chaptersUnavailable)&&(o.name=c(o.chapter),copyToObject(assets.get(o.name),o)),"book"==o.scope&&(o.chapter=""),o.chapterTitle=getChapterTitle(o.chapter),"chapter"==o.scope&&-1!=$.inArray(o.chapter,o.chaptersUnavailable)&&(o.available=!1),"_none"==o.bucket?(o.menuName=o.name,o.bucket="",o.bucketInd=-1):(o.menuName=o.bucket,o.bucketInd=assets.getBucketIndex(o.name)),o.sections.length>0&&(o.sections="chapter"==o.scope?o.sections[parseInt(o.chapter,10)]:o.sections[0],"undefined"==typeof o.sections&&(o.sections=[])),"download"==o.template&&(0===o.sections.length&&(o.sections=[],o.sections[0]=new assets.sectionObj),o.sections[0].title||(o.sections[0].title=o.linkTitle),o.sections[0].url||(o.sections[0].url=o.url)),o.assetProtected=o["protected"],o.assetProtected&&-1!=$.inArray(o.chapter,o.chaptersFree)&&(o["protected"]=!1),"glossary"==o.assetType&&"popup"==o.behavior)o.url=makePath([allSites.engineDirs.root],"#"+n(o));else{if(o.sections.length>0){for(var f=0,g=o.sections.length;g>f;f++)o.sections[f].url=replaceVars(o.sections[f].url,o),o.dir&&"relative to site"==getUrlType(o.sections[f].url)&&(o.sections[f].url=makePath([o.dir],o.sections[f].url)),o.sections[f].url=r(o.sections[f].url,o),o.sections[f].urlNoExtension=removeExtension(o.sections[f].url),o.sections[f].extension=getExtension(o.sections[f].url);o.url=o.sections[0].url}o.url=replaceVars(o.url,o),o.urlType=getUrlType(o.url),o.url=r(o.url,o),o.extension=getExtension(o.url),o.urlNoExtension=removeExtension(o.url),!o.dir&&o.url&&(o.dir=removeFilename(o.url))}if("video"==o.assetType||"audio"==o.assetType)o.template=o.assetType,o.showHeading=!0,o.sections.length>0&&(o.template+="_playlist",o.playlist=!0),o.templateStr=removeMediaOptions(allSites.templates[o.template],o),"audio"==o.assetType?(o.playerHeight=flashManager.playerHeightOffset,o.playerWidth="400"):(o.playerHeight=!o.playerHeight&&o.mediaOptions.videoHeight?(parseInt(o.mediaOptions.videoHeight,10)+parseInt(flashManager.playerHeightOffset,10)).toString():"360",o.playerWidth=!o.playerWidth&&o.mediaOptions.videoWidth?o.mediaOptions.videoWidth:"480");else if("template"==o.assetType){if("download"==o.template){if(!o.linkBullet)switch(o.extension){case"pdf":case"zip":case"ppt":case"psd":o.linkBullet=o.extension;break;case"doc":o.linkBullet="word";break;case"xls":o.linkBullet="excel";break;case"html":case"htm":o.linkBullet="flash";break;default:o.linkBullet="document"}if(!o.helpLink){switch(o.extension){case"pdf":m="0";break;case"zip":m="1";break;case"doc":m="2";break;case"html":case"htm":m="3";break;case"ppt":m="4";break;case"xls":m="5";break;case"psd":m="6"}o.helpLink=m?"/coursemate/shared/help/download_help.html?panel="+m+"#Accordion1":"/coursemate/shared/help/download_help.html"}}o.showHeading=!0,o.templateStr=allSites.templates[o.template]}else"html"==o.assetType&&o.sections.length>1?(o.assetType="template",o.template="index",o.templateStr=allSites.templates.index):"cl_ebook"==o.assetType&&(o.template="cl_ebook",o.templateStr=allSites.templates[o.template]);o.template&&(o.templateStr=replaceVars(o.templateStr,o))}else o.behavior="embedded"}return o.id=n(o),"popup"==o.behavior&&"current"==this.classType&&currentStatus.shell?(this.popupLocation={},copyToObject(o,this.popupLocation)):(copyToObject(o,this),"temp"!=e&&currentStatus.update()),d=currentStatus.shell?o.behavior:"embedded"}function i(e){for(var t=assets.titles(),s=t.length,i=a(e),n=0;s>n;n++)if(i==a(t[n]))return assets.names()[n];return""}function a(e){var t=e.toLowerCase();return t=t.replace(/%20/g,"_"),t=t.replace(/'/g,""),t=t.replace(/[\W_]+/g,"_")}function n(e){var t=e.isbn;return"resource_center"==site.type&&e.resourceGroup&&(t+="/"+e.resourceGroup),"home"!=e.type&&(t+="/"+e.name,e.chapter&&(t+="/"+e.chapter),currentStatus.shell&&"popup"!=e.behavior&&"home"!=e.type&&!site.forceDemo&&(t+=":shell")),site.forceDemo&&(t+=":demo"),t}function r(e,t){var s="",i=getUrlType(e),a="",n=[];return"cl_ebook"==t.assetType?(e?null!=(n=e.match(/\bchapterName=([^&]+)/))&&(a=n[1]):a=o(t.chapterTitle),e=makePath([site.siteFiles.ebookDomain],"/vrle/retrieve.do?")+"eISBN="+site.siteFiles.ebookIsbn+"&prodId=VRL&chapterName="+a+"&token="+currentStatus.token):"relative to site"==i&&(s=t["protected"]&&t.standaloneProtected?!currentStatus.shell&&t.courseware?site.siteDirs.courseware:site.siteDirs["protected"]:site.siteDirs.unprotected,e=makePath([s],e)),e}function o(e){for(var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_.!~*'()",s="0123456789ABCDEF",i=e,a="",n=0;n<i.length;n++){var r=i.charAt(n);if(" "==r)a+="+";else if(-1!=t.indexOf(r))a+=r;else{var o=r.charCodeAt(0);o>255?a+="+":(a+="%",a+=s.charAt(o>>4&15),a+=s.charAt(15&o))}}return a}function c(e){for(var t=assets.names("menu"),s="",i=0,a=t.length;a>i&&(s=t[i],-1==$.inArray(e,assets.get(s).chaptersAvailable));i++);return s}copyToObject(new t,this),this.popupLocation=new t,this.classType=e,this.update=s}function Controller(){function e(e,t){var s={},i=currentLocation.update(e,t);return t||(t="url"),"popup"==i?(copyToObject(currentLocation.popupLocation,s),void tracker.update(s)):("error"==currentLocation.type?view.error(e):"home"==currentLocation.type?view.home():"report"==currentLocation.type?view.report():"all sites"==currentLocation.type?view.sitesIndex():"resource_center"!=site.type||"resource group"!=currentLocation.type||"resourceGroupMenu"!=t&&"url"!=t?("resource_center"!=site.type||"resourceGroupSubmenu"!=t&&"url"!=t||view.resourceGroup(t),currentLocation.bucket&&currentStatus.shell?view.contentPage("bucket"):view.contentPage()):view.resourceGroup(t),view.update(),void(currentStatus.shell&&(copyToObject(currentLocation,s),tracker.update(s))))}this.showLocation=e}function View(){function e(){function e(){if(site.siteFiles.instructorSite){var e='<li><a href="'+site.siteFiles.instructorSite+'"  target="_blank">Instructor Companion Site</a></li>';$("div#supportNav ul").prepend(e)}}function t(e){function t(e){function t(e,t,s,i){this.name=e,this.title=t,this.icon=makePath([site.engineDirs.icons],s),this.bucket=i}var s=[],i=[],a=[],n={};n="undefined"==typeof e?window:resourceCenter.getByIndex(e),a=n.assets.names("menu");for(var r=0,o=a.length,c="",l="",u={};o>r;r++)c=a[r],l=n.assets.get(c).bucket,"_none"!=l?-1==$.inArray(l,i)&&(u=new t(l,n.buckets.get(l).title,n.buckets.get(l).icon,l),i.push(l),s.push(u)):(u=new t(c,n.assets.get(c).title,n.assets.get(c).icon,""),s.push(u));return s}function s(e,t){var s="",i="",a=[],n={},r={},o="",c={};if(c="undefined"==typeof t?window:resourceCenter.getByIndex(t),e.bucket){if(r=c.buckets.get(e.bucket),a=r.assets,o=r.blurbShort?r.blurbShort:r.blurbLong,s+=' title="|',o)s+=o;else for(var l=0,u=a.length;u>l;l++)n=c.assets.get(a[l]),s+=n.title,u-1>l&&(s+="&nbsp;&bull; ");s+='"'}else n=c.assets.get(e.name),n.blurb&&(s+=makeRolloverTitle(n.name));return i='<li><img src="'+e.icon+'" class="assetimages"><span class="optionLabel"><a href="#'+site.makeLocationId(e.name,"")+'"><span'+s+">"+e.title+"</span></a></span></li>"}for(var i=t(e),a='<ul class="sideMenu">',n=0,r=i.length,o={};r>n;n++)o=i[n],a+=s(o,e);return a+="</ul>"}function s(){function e(){"resource_center"==site.type&&"compressed"==site.menuStyle&&$("#leftSide").addClass("compressedAccMenu compressedAccSubMenu")}function s(e,t){var s="",i="",a="";return 0===t&&(i=" rounded",a=' id="top"'),s='<div class="mainTopic'+i+'"><h3 class="accordionHead"'+a+'><img src="'+site.siteDirs.images+"/"+e.icon+'" class="topicIcon" border="0" /><span class="headLinkWrap"><a href="#/'+e.name+'" class="headLink"><span>'+e.site.title+'</span></a></span></h3><div class="clear"></div></div>'}function i(e){var t="",s=e.site.chapterTitles;t+='<ul class="subNavAccordion">';for(var i=0,a=s.length,n="";a>i;i++)n=i+site.startChapterNumber,t+=site.showChapterNumbers?'<li><span class="optionLabel"><span class="chapNum">'+n+'. </span><a href="#/'+e.name+"//"+n+'"><span>'+s[i]+"</span></a></span></li>":'<li><span class="optionLabel"><span class="chapNum"><a href="#/'+e.name+"//"+n+'">'+s[i]+"</a></span></span></li>";return t+="</ul>"}function a(){var e="";return $.ajax({url:site.engineFiles.leftPanel,async:!1,success:function(t){e=t}}),e}var n="",r=a();$("div#accordionMenu").empty();for(var o,c=0,l=resourceCenter.count;l>c;c++)o=resourceCenter.getByIndex(c),n+=s(o,c)+i(o)+'<div class="leftPanel">'+r+'<div class="sideMenuWrapper" >'+t(c)+'</div><div class="clear"></div></div>';$("div#accordionMenu").html(n),e()}function i(){function e(){function e(e,t,s,i){this.name=e,this.title=t,this["protected"]=s,this.linkStyle=i}for(var t=[],s=assets.names("navBar"),i=0,a=s.length,n="",r={};a>i;i++)n=s[i],r=new e(n,assets.get(n).title,assets.get(n)["protected"],assets.get(n).linkStyle),t.push(r);return t}function t(e){var t="",s="",i=assets.get(e.name),a=makeRolloverTitle(i.name);return e["protected"]&&(t=" protected"),s='<li class="navItem'+t+'"><a href="#'+site.makeLocationId(e.name,"")+'" class="'+e.linkStyle+'"'+a+">"+e.title+"</a></li>"}var s="",i=e();$("div#navBar ul#navItems").empty(),s+='<li class="first"><a href="#" class="location-id">Home</a></li>',"4ltr"==site.type&&(s+='<li><a href="/engagement_tracker/Overview.html" class="popup large">Engagement Tracker</a></li>');for(var a=0,n=i.length,r={};n>a;a++)r=i[a],s+=t(r);$("div#navBar ul#navItems").append(s)}function a(){var e=site.siteFiles.homePageBaseFilename+".html";loadImages(),"premium"==site.type||"resource_center"==site.type?fileLoader.loadFileIntoPage("#homeIntro","",e):"4ltr"==site.type&&(fileLoader.loadFileIntoPage(".txtBoxCopy","",e),$("#logoText").html(site.title),site.title.length>4&&$("#logoText").css("font-size","25px")),$("#bookTitle").html(site.title),$("#bookSubtitle").html(site.subtitle),$("#edition").html(site.edition),$("#author").html(site.author),$("a#engagementTracker").click(function(){return view.tracker(),!1}),currentStatus.chapterMenu=0,$("#chapterMenuLabel").text("Select a "+site.labels.chapterSingular),"resource_center"==site.type&&$("#courseSelectLabel").text("Change "+site.labels.resourceGroupSingular),$("#chapterList li").live("click",function(){var e=$(this).find("a").attr("href");return disablePopup(),currentStatus.updateChapterView("single"),controller.showLocation(e,"chapterMenu"),!1}),$("#backgroundPopup").css({opacity:"0.7"}),$(".selectChapter").text("Select "+site.labels.chapterSingular),$(".selectChapter").click(function(){return-1==$(this).attr("class").indexOf("inactive")&&loadPopup(),!1}),$("#closeChapterMenu").click(function(){disablePopup()}),$(".previousChapter").mousedown(function(){-1!=$(this).attr("class").indexOf("active")&&goToChapter("previous")}),$(".nextChapter").mousedown(function(){-1!=$(this).attr("class").indexOf("active")&&goToChapter("next")}),$(".thisChapter").text("This "+site.labels.chapterSingular),$(".allChapters").text("All "+site.labels.chapterPlural),$(".thisChapter").mousedown(function(){-1==$(".chapterView").attr("class").indexOf("inactive")&&(currentStatus.updateChapterView("single"),setChapterViewButtons(),controller.showLocation(currentLocation.id))}),$(".allChapters").mousedown(function(){-1==$(".chapterView").attr("class").indexOf("inactive")&&(currentStatus.updateChapterView("all"),setChapterViewButtons(),controller.showLocation(currentLocation.id))}),$("a.popup").click(function(){var e=$(this).attr("class"),t=!1,s=$(this).attr("href");return-1!=$(this).parent().attr("class").indexOf("navItem")&&(controller.showLocation(s),s=currentLocation.popupLocation.url,currentLocation.popupLocation.linkStyle&&(e=currentLocation.popupLocation.linkStyle),t=!0),openPopup(s,e,t),!1}),$("#survey a").attr("href",site.siteFiles.survey);var t=$(".navItem").find("a").css("color");$(".navItem").hover(function(){$(this).find("a").css("color","#ce3c23").css("text-decoration","underline"),$(this).css("cursor","pointer")},function(){$(this).find("a").css("color");$(this).find("a").css("color",t).css("text-decoration","none"),$(this).css("cursor","default")}),$(".navItem a").cluetip({width:"200px",positionBy:"bottomTop",splitTitle:"|",showTitle:!1,cursor:"",clickThrough:!0}),$("a.location-id").click(function(){var e=$(this).attr("href");return controller.showLocation(e),!1}),$("ul.sideMenu li").click(function(){var e=$(this).find("a").attr("href");return controller.showLocation(e),!1}),$("ul.sideMenu li").mousedown(function(){u(),$(this).addClass("sub-selected")}),$("ul.sideMenu li").mouseover(function(){"sub-selected"!=$(this).attr("class")&&$(this).find("a").css("text-decoration","underline")}),$("ul.sideMenu li").mouseout(function(){$(this).find("a").css("text-decoration","none")}),$(".sideMenu span.optionLabel span").cluetip({width:"200px",splitTitle:"|",showTitle:!1,cursor:"",clickThrough:!0}),"resource_center"==site.type&&($("div.mainTopic").click(function(){$("*").css("cursor","progress");var e=$(this).find("a").attr("href");return controller.showLocation(e,"resourceGroupMenu"),$("*").css("cursor",""),$(this).next().toggle(),$("#homeIntro").show(),$("img#homePageImg").attr("src",site.siteFiles.homePageImage),$("#contentArea").hide(),$("#homePage").show(),!1}),$("ul.subNavAccordion li").click(function(){var e=$(this).find("a").attr("href");return controller.showLocation(e,"resourceGroupSubmenu"),!1})),$bucketTabs=$("#bucketTabs").tabs({show:function(e,t){var s=t.panel.id,i=s+"-iframe";isFirstTab(s)||sizeIframe(i)}})}e(),$("#loading").bind("ajaxSend",function(){$("html").addClass("busy"),$(this).show()}).bind("ajaxStop",function(){$("html").removeClass("busy"),$(this).hide()
}),"resource_center"!=site.type?$("div.sideMenuWrapper").html(t()):s(),i(),"resource center"!=site.type&&c(),a(),tracker.init(),currentStatus.authenticated||(loginDiv="4ltr"==site.type?"div.homeTopRight":"div#homeLogin",loadLogin(loginDiv))}function t(){function e(){var e="",t="&nbsp;&gt;&nbsp;",s="";"home"==currentLocation.type?e+="Home":(e+="<div>"+makeLink("Home","#")+"</div>","resource_center"==site.type&&(s=resourceCenter.get(currentLocation.resourceGroup).site.title,e+="<div>"+t+s+"</div>"),"chapter"==currentLocation.scope&&currentLocation.chapter&&(e+="<div>"+makeChapterStr(t)+"</div>"),currentLocation.bucket&&(e+="<div>"+t+buckets.get(currentLocation.bucket).title+"</div>"),"asset"==currentLocation.type&&(e+="<div>"+t+currentLocation.title+"</div>")),$("#breadcrumbs span").html(e),$("#breadcrumbs a").mousedown(function(){urlValue=$(this).attr("href"),controller.showLocation(urlValue)})}function t(){$(".currentChapter div").html(makeChapterStr())}function s(){var e="",t=[],s="",i=[];u(),h(),$(".sideMenu li").each(function(){var s=$(this).find("a").attr("href");null!=(t=s.match(/\/([^\/]+)$/))&&(e=t[1]),e==currentLocation.menuName&&($(this).addClass("sub-selected"),$(this).find("a span").trigger("hideCluetip"))}),$("div.mainTopic").each(function(){var e=$(this).find("a").attr("href");null!=(i=e.match(/\/([^\/]+)$/))&&(s=i[1]),""!=currentLocation.resourceGroup?s==currentLocation.resourceGroup&&$(this).addClass("selected"):h()})}function i(){"home"==currentLocation.type||"resource group"==currentLocation.type||"book"==currentLocation.scope||currentStatus.chapter==currentLocation.chaptersAvailable[0]?($(".previousChapter").removeClass("active"),$(".previousChapter").addClass("inactive")):($(".previousChapter").removeClass("inactive"),$(".previousChapter").addClass("active")),"home"==currentLocation.type||"resource group"==currentLocation.type||"book"==currentLocation.scope||currentStatus.chapter==currentLocation.chaptersAvailable[currentLocation.chaptersAvailable.length-1]?($(".nextChapter").removeClass("active"),$(".nextChapter").addClass("inactive")):($(".nextChapter").removeClass("inactive"),$(".nextChapter").addClass("active")),"book"==currentLocation.scope&&"home"!=currentLocation.type?($(".selectChapter").removeClass("active"),$(".selectChapter").addClass("inactive")):($(".selectChapter").removeClass("inactive"),$(".selectChapter").addClass("active")),setChapterViewButtons()}function a(){$("#chapterList li").each(function(){var e=$(this).find("a").attr("href"),t="",s=[];e&&(null!=(s=e.match(/\d+$/))&&(t=s[0]),t==currentStatus.chapter?$(this).addClass("selected"):$(this).removeClass("selected"))})}function n(){var e,t,s="",i=[],a=[];(currentStatus.isNewChapter||!p)&&($(".sideMenu li").each(function(){var n=$(this).find("a").attr("href");if($icon=$(this).children("img"),null!=(a=n.match(/\/([^\/]+)$/))&&(s=a[1]),"asset"==getContentType(s)){var r=site.engineDirs.icons+"/"+removeExtension(assets.get(s).icon)+"_disabled.gif",o=site.engineDirs.icons+"/"+assets.get(s).icon;"hide"==site.unavailableMenuOptions&&-1!=$.inArray(currentStatus.chapter,assets.get(s).chaptersUnavailable)?$(this).hide():"gray"==site.unavailableMenuOptions&&-1!=$.inArray(currentStatus.chapter,assets.get(s).chaptersUnavailable)?($(this).addClass("grayAsset").find("a").trigger("hideCluetip"),$icon.attr("src",r)):($(this).show(),$(this).removeClass("grayAsset"),$icon.attr("src",o),-1!=$.inArray(currentStatus.chapter,assets.get(s).chaptersFree)?$(this).removeClass("protected"):assets.get(s)["protected"]&&$(this).addClass("protected"))}else{i=assets.getByBucket(s),e=!0,t=!0;for(var c=0,l={};c<i.length;c++)l=i[c],l["protected"]&&-1==$.inArray(currentStatus.chapter,l.chaptersFree)||(e=!1),-1==$.inArray(currentStatus.chapter,assets.get(l.name).chaptersUnavailable)&&(t=!1);"hide"==site.unavailableMenuOptions&&t?$(this).hide():($(this).show(),e?$(this).addClass("protected"):$(this).removeClass("protected"))}}),p=!0)}currentStatus.shell&&(e(),t(),s(),n(),i(),a(),window.location.hash=currentLocation.id)}function s(){var e="";"resource_center"==site.type&&(e=site.siteFiles.homePageBaseFilename+".html",fileLoader.loadFileIntoPage("#homeIntro","",e)),u(),"resource_center"==site.type&&($(".leftPanel").hide(),$("#accordion").show()),"premium"==site.type||"resource_center"==site.type?($("#contentError").hide(),$("#contentArea").hide(),"normal"==site.menuStyle?$("ul.subNavAccordion").show():"compressed"==site.menuStyle&&$("ul.subNavAccordion").hide()):"4ltr"==site.type&&($("#mainArea").hide(),$("#homeImage").css("background-image","url("+site.siteFiles.homePageImage+")")),$("#book").show(),$("#homePage").show()}function i(e){var t=currentLocation.resourceGroup,s=currentLocation.chapter,i=resourceCenter.names(),a=resourceCenter.getIndex(t),n=site.siteFiles.homePageBaseFilename+".html";currentLocation.sectionsFile||fileLoader.loadSiteDefinition(resourceCenter.values[a].assets.values,a),fileLoader.loadFileIntoPage("#homeIntro","",n),"resource group"==currentLocation.type&&($("img#homePageImg").attr("src",site.siteFiles.homePageImage),$("a.buy-online").attr("href",site.siteFiles.buyOnline+site.isbnCore),$("#contentArea").hide(),$("#homePage").show());for(var r=0,o=i.length;o>r;r++)r!=a?($("div.leftPanel:eq("+r+")").slideUp("600"),$("ul.subNavAccordion:eq("+r+")").slideUp("600")):"resourceGroupMenu"==e||"url"==e&&"resource group"==currentLocation.type?($("ul.subNavAccordion:eq("+r+")").slideDown("600"),$("div.leftPanel:eq("+r+")").slideUp("600")):"resourceGroupSubmenu"!=e&&"url"!=e||!s||($("div.leftPanel:eq("+a+")").slideDown("600"),$("ul.subNavAccordion:eq("+a+")").slideUp("600"));currentStatus.isNewResourceGroup&&c()}function a(e){$("#contentError").text('The location "'+e+'" could not be found.'),$("#book").hide(),$("#homePage").hide(),$("#contentArea").hide(),$("#contentError").show()}function n(){var e=new SiteReport;$("#contentArea").html("Creating report . . ."),$("#contentArea").html(e.text)}function r(){$("#contentArea").html(allSitesIndex.text),"production"==currentStatus.server?allSitesIndex.getDetails():allSitesIndex.init()}function o(e){function t(e){for(var t=assets.getByBucket(e),s=t.length,i={},a={},n="",r=0,o=$("#bucketTabs").tabs("length");o>r;r++)$bucketTabs.tabs("remove",0);currentStatus.tabLoaded=[];for(var r=0,c="";s>r;r++)i=t[r],n="#"+i.name,c='<div id="'+i.name+'"></div>',$("#bucketTabs").append(c).tabs("add",n,i.title),$("#bucketTabs a").click(function(){var e=$(this).attr("href"),t=e.replace("#",""),s=site.makeLocationId(t,"");controller.showLocation(s)}),i["protected"]&&$("#bucketTabs li:last a").append('<span class="protected">&nbsp;</span>'),$("#bucketTabs li:last span:first").attr("title",makeRolloverTitle(i.name,!1)),$bucketTabs.tabs("select",currentLocation.bucketInd);$("#bucketTabs li span").cluetip({width:"200px",positionBy:"bottomTop",topOffset:20,splitTitle:"|",showTitle:!1,cursor:"",clickThrough:!0});for(var r=0,u="",h="";s>r;r++)i=t[r],h=site.makeLocationId(i.name,currentStatus.chapter),tempLocation.update(h),copyToObject(tempLocation,a),n="#"+i.name,u="#bucketTabs div"+n,l(u,a),currentStatus.tabLoaded[r]="ilrn"==tempLocation.assetType&&"single"==currentStatus.chapterView?!1:!0;currentStatus.tabContent=i.bucket}switch(e||(e="asset"),e){case"bucket":var s="#"+currentLocation.name,i="#bucketTabs div"+s;currentStatus.tabContent!=currentLocation.bucket?t(currentLocation.bucket):(l(i,currentLocation),$bucketTabs.tabs("select",currentLocation.bucketInd)),$("#assetContent").hide(),$("#bucketContent").show();break;case"asset":var a=assets.get(currentLocation.name),n=buckets.get(a.bucket).title,r=(n+": "+a.title,"");r="index"==currentLocation.assetType||"index"==currentLocation.template?"#assetTabs #tabsMenu":"#assetText",l(r,currentLocation),currentStatus.shell&&($("#bucketContent").hide(),$("#assetContent").show()),"index"==currentLocation.assetType||"index"==currentLocation.template?(initAssetTabs(),$("#menuTab").text(currentLocation.menuTabLabel),$("#contentTab").text(currentLocation.contentTabLabel),$("#assetText").hide(),$("#assetTabs").show()):($("#assetTabs").hide(),$("#assetText").show())}currentStatus.shell&&($("#contentError").hide(),$("#book").hide(),$("#homePage").hide(),"premium"==site.type||"resource_center"==site.type?$("#contentArea").show():"4ltr"==site.type&&($("#homeImage").css("background-image","none"),$("#mainArea").show()),$(".sideMenu").show())}function c(){for(var e="",t="",s="",i="",a="",n=Math.ceil(site.chapterCount/2)-1,r=0,o=0,c="",l="",u="";r<site.chapterCount;r++)o=(r+site.startChapterNumber).toString(),0===site.demoChapters.length||-1!=$.inArray(o,site.demoChapters)?(u="",c='<a href="#'+site.makeLocationId("",o)+'">',l="</a>"):(u=' class="inactive"',c="",l=""),a=site.showChapterNumbers?o+".":"&bull;",e="<li "+u+'><div class="chapterTitle"><div class="chapNum">'+a+'</div><div class="chapTitle">'+c+site.chapterTitles[r]+l+"</div></div></li>",n>=r?t+=e:s+=e;i='<ul id="left-chapter-column" class="popupMenu leftColumn">'+t+'</ul><ul id="right-chapter-column" class="popupMenu rightColumn">'+s+"</ul>",$("div#chapterList").html(i)}function l(e,t){function s(e){for(var t='<ul class="allChapters">',s=!1,i='<div class="missing">This resource is not available for some '+site.labels.chapterPlural.toLowerCase()+".</div>",a=0,n=currentLocation.name,r=0,o="",c="",l="",u=!0,h="";a<site.chapterCount;a++)r=(a+site.startChapterNumber).toString(),u=!0,-1==$.inArray(r,currentLocation.chaptersAvailable)&&(u=!1),0!==site.demoChapters.length&&-1==$.inArray(r,site.demoChapters)||!u?(l=' class="inactive"',o="",c="",u||(s=!0)):(l="",o='<a href="#'+site.makeLocationId(n,r)+'">',c="</a>"),h=site.showChapterNumbers?r+". ":"&bull; ",t+="<li "+l+"><span>"+h+o+site.chapterTitles[a]+c+"</span></li>";t+="</ul>",s&&(t=i+t),$(e).html(t),$(e+" a").click(function(){var e=$(this).attr("href");return currentStatus.updateChapterView("single"),controller.showLocation(e),setChapterViewButtons(),!1})}function i(){site.assetMargin||(site.assetMargin=$("#assetContent").css("margin-left")),currentLocation.margin?($("#assetContent").css("margin-left",currentLocation.margin),$("#assetContent").css("margin-right",currentLocation.margin)):$("#assetContent").css("margin-left")!=site.assetMargin&&($("#assetContent").css("margin-left",site.assetMargin),$("#assetContent").css("margin-right",site.assetMargin))}return t["protected"]&&!currentStatus.authenticated&&(!t.courseware&&t.standaloneProtected||currentStatus.shell)?void loadLogin(e):t.available||"single"!=currentStatus.chapterView?((-1==t.bucketInd||1!=currentStatus.tabLoaded[t.bucketInd])&&("all"==currentStatus.chapterView?s(e):"video"==t.assetType||"audio"==t.assetType||"template"==t.assetType||"cl_ebook"==t.assetType?(makeFromTemplate(t,e),"index"==t.template&&makeOpenInTab(e)):"glossary"==t.assetType?makeGlossary(e):fileLoader.loadFileIntoPage(e,t),currentStatus.tabLoaded[t.bucketInd]="mozilla"==currentStatus.browser&&"ilrn"==t.assetType&&"single"==currentStatus.chapterView?!1:!0),!t["protected"]||currentStatus.authenticated||!t.courseware&&t.standaloneProtected||currentStatus.shell||$(e+" a[href*='/student/']").attr("href",function(){return this.href.replace("student","courseware")}),t.instructions&&(0===$(e+" div.instructions").length&&$(e).prepend('<div class="instructions">'),$(e+" div.instructions").html(t.instructions)),t.showHeading?(0===$(e+" div.assetHeading").length&&$(e).prepend('<div class="assetHeading">'),$(e+" div.assetHeading").html(t.heading)):$(e+" div.assetHeading").remove(),void i()):void showNotAvailable(e,t)}function u(){$(".sideMenu li").removeClass("sub-selected")}function h(){$("div.mainTopic").removeClass("selected")}var p=!1;this.init=e,this.update=t,this.home=s,this.resourceGroup=i,this.error=a,this.report=n,this.sitesIndex=r,this.contentPage=o}function LinksReport(){function e(){this.chapter="",this.name="",this.url=""}this.results=[];for(var t,s=assets.names().length,i=0,a="",n="",r="",o=[];s>i;i++){n=assets.names()[i],t=assets.get(n),r=t.url;for(var c=0,l="",u=0,h=0;c<site.chapterCount;c++)if(u=c+1,h=padNum(u),l=r.replace("[%chapterNumPadded%]",h),$.get(l,function(e){a=e}),a&&null!=(o=a.match(/href\="([^"+])"/gi))){for(var p=0,d=new e;p<o.length;p++)d.chapter=u,d.name="",d.url=o[p];t.links.push(chapterResults)}results.push(t)}}function SiteReport(){function e(e,t,s){return checkForPage(e,t),"success"!=ajaxResults.loadResult&&"inaccessible"!=ajaxResults.loadResult&&("undefined"==typeof s[e]&&(s[e]=[]),s[e].push(t)),s}var t="",s=eachPage(e);this.text=makeHead("SITE REPORT")+"<p>"+makeBold("Title: ")+site.title+"<br />"+makeBold("Author: ")+site.author+"<br />"+makeBold("Edition: ")+site.editionNumber+"<br />"+makeBold("Core Text ISBN: ")+site.isbnCore+"<br />"+makeBold("SSO ISBN: ")+site.isbn+"<br />"+makeBold("Number of Chapters: ")+site.chapterCount+"<br />"+makeBold("Site Directory: ")+site.siteDirs.root+"<br /></p>";for(var i in s)t+=makeHead(assets.get(i).title)+"Content missing for these chapters: "+s[i].join(", ");t&&(this.text+='<div class="missing">'+makeHead("The Following Assets Are Missing Content")+t+"</div>")}function AjaxResults(){this.loadResult="",this.pageContent=""}function AllSitesIndex(){function e(){$("a.launchSite").click(function(){window.location.href=$(this).attr("href"),window.location.reload()}),$("a#detailsButton").click(function(){return allSitesIndex.getDetails(),!1})}function t(){function e(e){var t="",s="",i="",a="",n="",r="",o={premium:"Premium Site","4ltr":"4LTR Press",resource_center:"Resource Center"},c={premium:"premium","4ltr":"fourLtr",resource_center:"resourceCenter"},l=allSitesIndex.sitesArray[allSitesIndex.listInd][1],u=$("book:last",e).find("title:first").text(),h=$("book:last",e).find("author:first").text(),p=$("book:last",e).find("edition-number:first").text(),d=$("book:last",e).find("discipline:first").text(),m=$("site",e).find("type:first").text(),f=($("site",e).find("menu-style").text(),$("site",e).find("demo-chapters").find("chapter-number:first").text()),g="#"+l,v=makePath([allSitesIndex.displayBaseUrl],"#"+l),b=allSitesIndex.sitesArray[allSitesIndex.listInd][0],y="",k="";f&&(k=' class="demo"'),m||(m="premium"),y=c[m],allSitesIndex.siteCount++,s+='<a class="launchSite" href="'+g+'">'+u+"</a>",p&&(s+=" (Edition "+p+")"),h&&(s+=", by "+h),s='<div class="title '+y+'">'+s+"</div>",i+=o[m],f&&(i+=" Demo"),d!=allSitesIndex.currentDiscipline&&(t='<li><div class="discipline">'+d+"</div></li>",$("ul#sitesList").append(t),allSitesIndex.currentDiscipline=d),i="<div"+k+">"+i+"</div>",a='<div class ="'+y+'">Site Launch URL: <a class="launchSite" href="'+g+'">'+v+"</a></div>","production"!=currentStatus.server&&(n="<div>Site Directory Name: "+b+"</div>"),r="<li>"+s+i+a+n+"</li>",$("ul#sitesList").append(r),$("span#siteCount").text(allSitesIndex.siteCount.toString())}var t='<div id="reportHeading"><span id="siteCount"></span>&nbsp;Websites</div><div id="loading">Loading...</div><ul id="sitesList"></ul>';$("div#contentArea").html(t);for(var s=0,i=this.sitesArray.length;i>s;s++){var a=makePath([this.sitesArray[s][0]],"site_definition.xml");if(0===a.indexOf("/testing/"))break;$.ajax({type:"GET",url:a,dataType:"xml",async:!1,success:e}),this.listInd+=1}$("div#loading").html("&nbsp;"),this.init()}var s=allSites.isbns(),i=allSites.dirs(),a="",n=s.length;this.baseUrl=removeHash(window.location.href),this.displayBaseUrl="http://"+window.location.host+"/site_engine",this.sitesArray=[],this.sites=[],this.listInd=0,this.siteCount=0,this.text="",this.currentDiscipline="";for(var r=0;n>r;r++)this.sitesArray.push([i[r],s[r]]);this.sitesArray.sort();for(var r=0,o="";n>r;r++)o=this.baseUrl+"#"+this.sitesArray[r][1],a+='<p>Site Launch URL: <a class="launchSite" href="'+o+'">'+makeBold("/site_engine/#"+this.sitesArray[r][1])+"</a><br />Site Directory Name: "+makeBold(this.sitesArray[r][0])+"</p>";this.text=makeHead(n+" WEB SITES")+'<div><a id="detailsButton" href="#">Show Details</a></div>'+a,this.init=e,this.getDetails=t}function FileLoader(){function e(){function e(e){function s(e,t,s){for(var i=h.slice(),a=u.slice(),n=0;n<i.length;n++)i[n]in t||(i.splice(n,1),n--);for(var n=0;n<a.length;n++)a[n]in s||(a.splice(n,1),n--);for(var n=0;n<a.length;n++)e.buckets.add(s[a[n]]);for(var n=0;n<i.length;n++)e.assets.add(t[i[n]],e)}var a=function(e,t,s){var i=l($(t));i.key()in s&&""!=i.content()&&(n(site[i.key()])?$(t).children().each(function(){var e=l($(this));""!=e.content()&&s[i.key()].push(e.content())}):s[i.key()]="number"==typeof site[i.key()]?parseInt(i.content(),10):i.content())},c=function(e,t,s){var i=l($(t));i.key()in s&&""!=i.content()&&(isObject(s[i.key()])?$(t).children().each(function(){var e=l($(this));e.key()in s[i.key()]&&""!=e.content()&&(s[i.key()][e.key()]=e.content())}):n(s[i.key()])?$(this).children().each(function(){var e=l($(this));""!=e.content()&&site[i.key()].push(e.content())}):s[i.key()]=isBoolean(site[i.key()])?strToBoolean(i.content()):i.content())},f=function(e,t){var s=l($(t));if("bucket"==s.type()&&""!=s.name()&&(u.push(s.name()),r(s.name())),"asset"==s.type()&&""!=s.name()){h.push(s.name()),o(s.name());var i=l($(t).parent());if("bucket"==i.type()&&""!=i.name){var a=l($(t).parent().parent());d[s.name()].bucket=i.name(),d[s.name()]["interface"]=a.key()}else"navBar"==i.key()&&(d[s.name()].bucket="navBar"),d[s.name()]["interface"]=i.key()}},g=function(e,t,s){var i=(l($(t)),$(t).children("name").text());$(t).children().each(function(){var e=l($(this));s[i]&&e.key()in s[i]&&""!=e.content()&&""!=i&&-1!=$.inArray(i,u)&&(s[i][e.key()]=e.content())})},v=function(e,s,i,a){var n=(l($(s)),$(s).children("name").text());$(s).children().each(function(){var e=l($(this));"undefined"!=typeof i[n]&&e.key()in i[n]&&""!=e.content()&&""!=n&&-1!=$.inArray(n,h)&&(isObject(assets.assetObj()[e.key()])?$(this).children().each(function(){var t=l($(this));"undefined"!=typeof assets.assetObj()[e.key()]&&t.key()in assets.assetObj()[e.key()]&&""!=t.content()&&(i[n][e.key()][t.key()]=isBoolean(assets.assetObj()[e.key()][t.key()])?strToBoolean(t.content()):t.content())}):$.isArray(assets.assetObj()[e.key()])?$(this).children().each(function(){var t=l($(this));""!=t.content()&&i[n][e.key()].push(t.content())}):i[n][e.key()]=isBoolean(assets.assetObj()[e.key()])?strToBoolean(e.content()):e.content())}),"undefined"!=typeof i[n]&&i[n].sectionsFile&&0===resourceCenter.count?i[n]=t(i[n],a):"undefined"!=typeof i[n]&&i[n].sectionsFile&&"resource_center"==site.type&&currentLocation.chapter&&(i[n]=t(i[n],a))};$("clse > book",e).children().each(function(e,t){a(e,t,site)}),$("clse > site",e).children().each(function(e,t){c(e,t,site)}),$("clse > interface item",e).each(function(e,t){f(e,t)}),$("clse > buckets > bucket",e).each(function(e,t){g(e,t,p)}),$("clse > assets > asset",e).each(function(e,t){v(e,t,d)}),s(window,d,p),$("resource-center",e).children().each(function(){var e=l($(this));e.key()in resourceCenter&&""!=e.content()&&(resourceCenter[e.key()]=e.content())}),$("resource-group",e).each(function(e){m=resourceCenter.resourceGroup(),$(this).children(":not(substitutions)").each(function(e,t){var s=l($(t));s.key()in m&&""!=s.content()&&(m[s.key()]=s.content())}),$(this).find("book").children().each(function(e,t){a(e,t,m.site)}),$(this).find("site").children().each(function(e,t){c(e,t,m.site)});var t=$.extend(!0,{},d),n=$.extend(!0,{},p),r={};for(r.bucket=[],r.asset=[],$(this).find("interface").find("item").each(function(){var e=strToBoolean($(this).attr("display")),t=$(this).attr("name"),s=$(this).attr("type");e||r[s].push(t)}),i=0;i<r.bucket.length;i++)delete n[r.bucket[i]];for($(this).find("bucket").each(function(e,t){g(e,t,n)}),i=0;i<r.asset.length;i++)delete t[r.asset[i]];$(this).find("asset").each(function(s,i){v(s,i,t,e)}),s(m,t,n),resourceCenter.add(m)})}function t(e,t){var i,a,n=0,r=0,o=e.name,c={};if(c="undefined"==typeof t||null===t?window:m||resourceCenter.values[t],e.sectionsUrl=makePath([site.siteDirs.root],e.sectionsFile),i=s(e.sectionsUrl),$("sections",i).children().each(function(){var t=l($(this)),s=!1,i=assets.sectionObj();""!=t.content()&&$(this).children().each(function(){var e=l($(this));"undefined"!=i[e.key()]&&e.content()&&(i[e.key()]=e.content(),s=!0)}),s&&(n=parseInt(i.chapter,10),r=c.site.chapterTitles.length,a=c.site.startChapterNumber,chapterEnd=a+r-1,n>chapterEnd||a>n?errorHandler.update("Didn't load section for chapter "+i.chapter+" in "+o+" because there are only "+r+" chapters, starting with "+a+" and ending with "+chapterEnd):i.chapter?("undefined"==typeof e.sections[n]&&(e.sections[n]=[]),e.sections[n].push(i)):("undefined"==typeof e.sections[0]&&(e.sections[0]=[]),e.sections[0].push(i)))}),"chapter"==e.scope){for(var u=0;r>u;u++)"undefined"==typeof e.sections[u]&&(e.sections[u]=[],"cl_ebook"!=e.type&&e.chaptersUnavailable.push(u.toString()));e.chaptersUnavailable.sort(numerical)}return e}function s(e){var t;return $.ajax({type:"GET",url:e,dataType:"xml",async:!1,error:function(){errorHandler.update("Couldn't load section file"+e),t=null},success:function(e){t=e}}),t}function a(e){return e.toString().replace(/([A-Z]+)/g,function(e,t){return t.substr(0,1).toUpperCase()+t.toLowerCase().substr(1,t.length)}).replace(/[\-_\s](.)/g,function(e,t){return t.toUpperCase()})}function n(e){return $.isArray(e)}function r(e){return p[e]=new buckets.bucketObj,p[e].name=e,p[e]}function o(e){return d[e]=new assets.assetObj,d[e].name=e,d[e]}var c=makePath([site.siteDirs.root],allSites.engineFiles.siteDefinition),l=function(e){return function(){var t=e.get(0).tagName,s=e.text(),i=a(t),n=e.attr("name"),r=e.attr("type");_display=e.attr("display");var o={};return o.label=function(){return t},o.content=function(){return s},o.key=function(){return i},o.name=function(){return n},o.type=function(){return r},o.display=function(){return _display},o}()};if(2==arguments.length)gIndex=arguments[1],gAsset=arguments[0],-1===$.inArray(gIndex,this.lazyloaded)&&(this.lazyloaded.push(gIndex),$.each(gAsset,function(e,s){"undefined"!=typeof s&&s.sectionsFile&&(s=t(s,gIndex))}));else try{var u=[],h=[],p={},d={},m={};$.ajax({type:"GET",url:c,dataType:"xml",async:!1,error:function(){errorHandler.update("Couldn't load site_definition.xml"),errorHandler.type="fatal"},success:e})}catch(f){errorHandler.update("Error parsing site_definition.xml; "+f),errorHandler.type="fatal"}}function t(e,t,s){function i(e){function t(e){return e=e.replace(/(src ?= ?| href ?= ?)"([^"]+)"/gi,function(e,t,s){var i="";return"relative to site"==getUrlType(s)?i=t+'"'+makePath([currentLocation.dir],s)+'"':e})}function s(e){var t=[];return e=e.replace(/(<embed [^>]+type\="[^"]*flash[^"]*"[^>]*)>/i,function(e,s){return null===(t=e.match(/wmode ?\= ?"transparent"/i))?s+' wmode="transparent">':e})}return e=t(e),e=s(e)}var a="",n="",r="",o=t.url,c=t.name+"-iframe";s?(o=s,t.assetType="html"):o=t.url,confirmFileIsLoadable(o)&&(r=o?checkPageStatus(o,t.name):"not found","ok"==r?"index"!=t.assetType&&t.iframeHeight||"cross-domain"==t.urlType?("cross-domain"!=t.urlType||t.iframeHeight||(t.iframeHeight=site.defaultIframeHeight),a=makeIframe(c,o,t.iframeHeight),$(e).html(a),"auto"==t.iframeHeight&&canSizeIframe(t.name)&&sizeIframe(c,!0)):$.ajax({async:!1,cache:!0,url:o,complete:function(s,a){"success"==a&&(n=s.responseText,n=extractBody(n),n=i(n),$(e).html(n),$(document).ready(function(){initContentPage(e,t)}),"index"==t.assetType&&makeOpenInTab(e))}}):"not found"==r&&showComingSoon(e,t))}function s(e,t){"undefined"==typeof t&&(t=!0);var s=!1;$.ajaxSetup({async:!1}),$.getScript(e,function(){s=!0}),!s&&t&&alert("Couldn't load external JavaScript file."+constants.NL+e),$.ajaxSetup({async:!0})}function a(){function e(e){var t=[],s="";null!==(t=e.match(/<url name="instructor_companion_site">([^>]+)<\/url>/))&&(s=t[1],isUrl(s)&&(site.siteFiles.instructorSite=s)),null!==(t=e.match(/<url name="cl_ebook">([^>]+)<\/url>/))&&(s=t[1],site.siteFiles.ebookUrl=s,""===site.siteFiles.ebookDomain&&(site.siteFiles.ebookDomain=getHostname(s)),site.siteFiles.ebookIsbn=getValueFromQuery("eISBN",s),currentStatus.token=getValueFromQuery("token",s))}$.ajax({async:!1,url:site.siteFiles.ssoUrls,success:function(t){e(t)}})}this.loadSiteDefinition=e,this.loadFileIntoPage=t,this.getSsoUrls=a,this.loadScript=s,this.lazyloaded=[]}function loadTracker(){var e=makePath([allSites.engineDirs.js],"tracker.js");fileLoader.loadScript(e)}function loadCustomStylesheet(){loadStylesheet(site.siteFiles.stylesheet)}function loadStylesheet(e){var t=document.getElementsByTagName("head")[0],s=document.createElement("link");s.type="text/css",s.rel="stylesheet",s.href=e,s.media="screen",t.appendChild(s)}function FlashManager(){function e(e,t){var s="",i="",a="",n=[];switch(null!==(n=e.match(/[^#\. ]+$/))&&(a=n[0]),this.settings.playerId="player-"+a,this.settings.playlistId="playlist-"+a,this.assets[t.name]={playerId:this.settings.playerId,playlistId:this.settings.playlistId},this.settings.flashvars={file:"",backcolor:"efecec",frontcolor:"404040",id:this.settings.playerId,seamlesstabbing:"true",autostart:"false",dock:"false"},this.settings.params={allowscriptaccess:"sameDomain",bgcolor:"FFFFFF",wmode:"transparent"},this.settings.attributes={id:this.settings.playerId,name:this.settings.playerId},t.assetType){case"video":this.settings.flashvars.file=t.urlNoExtension+".flv",this.settings.flashvars.plugins="captions-1",this.settings.flashvars.captions=t.urlNoExtension+".xml",this.settings.flashvars["captions.fontsize"]="16",this.settings.flashvars["captions.back"]="true",this.settings.params.allowscriptaccess="always",this.settings.params.allowfullscreen="true",s=t.playerWidth,i=t.playerHeight;break;case"audio":this.settings.flashvars.file=t.urlNoExtension+".mp3",this.settings.params.allowfullscreen="false",s=t.playerWidth,i=t.playerHeight;break;case"glossary":this.settings.params.allowfullscreen="false",this.settings.params.wmode="window",this.settings.flashvars.id="player1",this.settings.attributes.id="player1",this.settings.attributes.name="player1",s="0",i="0"}t.mediaOptions.streamer&&(this.settings.flashvars.streamer=t.mediaOptions.streamer),swfobject.embedSWF(allSites.engineFiles.jwPlayer,"playercontainer",s,i,"9.0.124",!1,this.settings.flashvars,this.settings.params,this.settings.attributes),$(e+" ul").attr("id",this.settings.playlistId)}function t(e){var t=[],s=this.assets[e.name].playlistId,a=this.player,n="div#"+e.name+"MediaArea";e.playlist&&($("#"+s+" a.playMedia").each(function(s){t[s]={file:e.sections[s].url,captions:e.sections[s].urlNoExtension+".xml"},$(this).bind("click",function(){return a.sendEvent("ITEM",s),e.mediaOptions.viewTranscript&&i(s),!1})}),a.sendEvent("LOAD",t),a.addControllerListener("ITEM","toggleSelected")),$(n+" div.mediaText").css("width",e.playerWidth+"px")}function s(e){var t="div#"+e.name+"MediaArea";e.mediaOptions.viewTranscript&&($(t+" div.transcriptPane").css("width",e.playerWidth+"px"),i(0),$(t+" a.viewTranscript").click(function(){$(t+" div.transcriptPane").toggle(),$(t+" a.viewTranscript").html($(t+" div.transcriptPane").is(":visible")?"Hide Transcript":"View Transcript")}))}function i(e){var t="";t=currentLocation.playlist?currentLocation.sections[e].urlNoExtension+".html":currentLocation.urlNoExtension+".html",$.ajax({url:t,success:function(e){e=extractBody(e),$("div.transcriptText").html(e)},error:function(){$("div.transcriptText").html("No Transcript Available")}}),$("div.transcriptText").scrollTop(0)}this.assets={},this.settings={},this.player=null,this.allPlayers=[],this.playerHeightOffset="20",this.setFlash=e,this.loadPlaylist=t,this.setTranscript=s}function toggleSelected(e){var t=$("#contentArea ul[className^='playlist'] li:visible")[e.index];$("#contentArea li.selected").removeClass("selected"),$(t).addClass("selected")}function playerReady(e){flashManager.allPlayers.push(e.id),flashManager.player=document.getElementById(e.id),"glossary"!=currentLocation.type&&(flashManager.loadPlaylist(currentLocation),flashManager.setTranscript(currentLocation))}function getContentType(e){var t="";return-1!=$.inArray(e,assets.names())?t="asset":-1!=$.inArray(e,buckets.names())&&(t="bucket"),t}function getUrlType(e){var t="",s=[];return e?null!==(s=e.match(/^http\:\/\//))?(t="absolute",getHostname(e)!=currentStatus.hostname&&(t="cross-domain")):t=null!==(s=e.match(/^file\:\/\//))?"hard disk":null!==(s=e.match(/^\//))?"relative to server":"relative to site":t="none",t}function eachPage(e){for(var t,s,i={},a=assets.names().length,n=0,t="";a>n;n++){t=assets.names()[n];for(var r=0,s=0;r<site.chapterCount;r++)s=r+1,i=e(t,s,i)}return i}function checkForPage(e,t){var s=currentLocation.isbn+"/"+e;t&&(s+="/"+t),tempLocation.update(s),"cross-domain"!=tempLocation.urlType?$.ajax({url:tempLocation.url,async:!1,success:function(e,t){ajaxResults.loadResult=t},error:function(e,t){ajaxResults.loadResult=t}}):ajaxResults.loadResult="inaccessible"}function getLocationId(e){if(0===arguments.length&&(e=window.location.hash),!e)return"";var t=e.replace(/^[^#]*#/,"");return t=t.replace(/\?[^\?]*$/,""),t=t.replace(/\/+$/,"")}function replaceVars(e,t){function s(e){if(!e)return"";for(var t=0,s=a.length,r="",o="",c=new RegExp;s>t;t++)r=a[t],o=null!==(n=r.match(/sections\.(\d+)\.(.+)/))?i.sections[n[1]-1][n[2]]:null!==(n=r.match(/([^\.]+)\.(.+)/))?i[n[1]]?i[n[1]][n[2]]:"":i[r],"undefined"==typeof o&&(o=""),c=new RegExp("\\[%"+r+"%\\]","g"),e=e.replace(c,o);return e}if(!e)return"";var i={},a=[],n=[],r="",o="",c=/\[%(.+?)%\]/g,l=/\[%beginSection%\]([\s\S]+?)\[%endSection%\]/;for(copyToObject(site,i),t?copyToObject(t,i):copyToObject(currentLocation,i),i.chapter&&(i.chapterNum=i.chapter,i.chapterNumPadded=padNum(i.chapter,2));null!==(n=c.exec(e));)a.push(n[1]);if(-1!=$.inArray("beginSection",a)){if(null!==(n=e.match(l))){r=n[1];for(var u,h=0,p=t.sections.length;p>h;h++)u=t.sections[h],i.section={},copyToObject(u,i.section),o+=s(r)}e=e.replace(l,o)}return a.length>0?e=s(e):e}function removeMediaOptions(e,t){return t.mediaOptions.downloadMedia||(e=e.replace(/<span class="downloadMedia">[\s\S]+?<\/span>/,"")),t.mediaOptions.downloadTranscript||(e=e.replace(/<span class="downloadTranscript">[\s\S]+?<\/span>/,"")),t.mediaOptions.viewTranscript||(e=e.replace(/<div class="transcriptPane"><div class="transcriptText"><\/div><\/div>/,""),e=e.replace(/<div class="transcriptToggle">[\s\S]+?<\/div>/,"")),e}function openPopup(e,t,s,i){"undefined"==typeof s&&(s=!1);var a,n="",r="",o=[],c={toolbar:"no",directories:"no",location:"no",resizable:"yes",menubar:"no",scrollbars:"yes",status:"no"},l=!1,u="",h="",p=800,d=560,m=screen.width-10,f=screen.height-60,g="",v="";s?(g=currentLocation.popupLocation.windowWidth,v=currentLocation.popupLocation.windowHeight):(g=currentLocation.windowWidth,v=currentLocation.windowHeight),!t&&currentLocation.linkStyle&&(t=currentLocation.linkStyle),t&&(o=t.split(" ")),e?(r=e,r=r.replace(/http|\W/gi,"")):r=currentLocation.popupLocation.name;for(var b=0;b<o.length;b++)switch("showAll"==o[b]?(c.toolbar="yes",c.directories="yes",c.location="yes",c.menubar="yes",c.status="yes"):"showNav"==o[b]?(c.toolbar=$.browser.mozilla?"yes":"no",c.directories="no",c.location=$.browser.msie?"yes":"no",c.menubar="no",c.status="no"):"fixed"==o[b]?(c.scrollbars="no",c.resizable="no"):"noScroll"==o[b]?c.scrollbars="no":"noResize"==o[b]&&(c.resizable="no"),o[b]){case"vpg-ebook":case"vpgEbook":case"clEbook":u="945",h="720";break;case"crossword":r="crossword",u="730",h="530";break;case"timeline":u="900",h="680";break;case"speakUp":u="775",h="720";break;case"website":u="1024",h="768",c.toolbar="yes",c.directories="yes",c.location="yes",c.menubar="yes",c.status="yes";break;case"large":u="1024",h="768"}u||(u=g&&"0"!=g?g:p),h||(h=v&&"0"!=v?v:d),c.width=parseInt(u,10),c.width>m&&(c.width=m,l=!0),c.height=parseInt(h,10),c.height>f&&(c.height=f,l=!0),c.width=c.width.toString(),c.height=c.height.toString(),l?(c.scrollbars="yes",c.resizable="yes",c.top=0):c.top=20,c.left=Math.round(screen.width/2-parseInt(c.width,10)/2);for(var y in c)n+=""===n?"":",",n+=y+"=",n+=c[y];
return a=window.open(e,r,n),i&&(a.document.write(i),a.document.close()),a.focus(),!1}function loadLogin(e){var t=allSites.engineFiles.login;"4ltr"==site.type&&(t=allSites.engineFiles.login4ltr),$.ajax({url:t,success:function(t){var s="";"4ltr"==site.type&&(s="Chapter",site.chaptersFree.length>1&&(s+="s"),s+=" "+makeListWithCommas(site.chaptersFree),t=t.replace("the Free Sample Chapter",s)),$(e).html(t),$("div#contentArea div.loginHeading.home").hide(),$("div#homeLogin div.loginHeading.asset").hide(),$("a.buy-online").attr("href",site.siteFiles.buyOnline+site.isbnCore)}})}function confirmFileIsLoadable(e){var t=["flv","mp4","mp3","swf","gif","jpg","zip","pdf","ppt","doc"],s=getExtension(e).toLowerCase();return s?-1==$.inArray(s,t)?!0:(alert("The file "+e+" cannot be loaded directly into a content page by AJAX because it is a binary file. You may need to correct the asset type for this file in site_definition.xml"),!1):!0}function getLogoFile(){var e=allSites.disciplines[site.discipline][1],t=allSites.subbrands[e][0]+".jpg";return t}function loadImages(){var e=makePath([site.engineDirs.logos],getLogoFile());$("#logoForeground a").html('<img src="'+e+'" />'),e=makePath([site.siteDirs.images],"book_cover.jpg"),"resource_center"!==site.type?$("#bookInfoWrapper").css("backgroundImage","url("+e+")"):$("#bookThumb").html('<img src="'+e+'" />'),"premium"==site.type&&$("#home").css("background-image","url("+site.siteFiles.homePageImage+")"),"resource_center"==site.type&&(e=makePath([site.engineDirs.images],"resource_center/home_page_toprepeat.jpg"),$("#hometext").css("background-image","url("+e+")").css("background-repeat","repeat-y"))}function isBucketProtected(e){for(var t=assets.getByBucket(e),s=!0,i=0,a=t.length;a>i;i++)if(!t[i]["protected"]){s=!1;break}return s}function makeIframe(e,t,s){var i="",a="";return"auto"!=s&&(a=' height="'+s+'"'),i='<iframe id="'+e+'" src="'+t+'" width="100%"'+a+'" marginwidth="0" marginheight="0" vspace="0" hspace="0" frameborder="0" scrolling="auto"></iframe>'}function makeRolloverTitle(e,t){var s="",i=assets.get(e);return"undefined"==typeof t&&(t=!0),i.blurb&&(s+="|"+i.blurb),t&&(s=' title="'+s+'"'),s}function sizeIframe(e,t){function s(e){var t="",s=0,i=parseInt(allSites.defaultIframeHeight,10);$(e).css({height:0}),t=$(e).contents().find("body").attr("scrollHeight"),s=Math.round(t/10),t+=s,i>t&&(t=i),$(e).css({height:t})}var i="#"+e,a=$(i).attr("height");"undefined"==typeof t&&(t=!1),a||(t?$(i).load(function(){s(i)}):s(i))}function makeFromTemplate(e,t){$(t).html(e.templateStr),$(document).ready(function(){initContentPage(t,e)}),flashManager.setFlash(t,e)}function makeGlossary(e){var t="";"single"==currentStatus.chapterView&&(t=currentLocation.chapter);var s='<div id="glossary"></div><script type="text/javascript">glossary.initPage('+t+");</script>";$(e).html(s),site.glossary.audio&&flashManager.setFlash(e,currentLocation)}function canSizeIframe(e){var t=assets.get(e),s=!1;return s="cross-domain"==getUrlType(t.url)?!1:!0}function isFirstTab(e){var t=!1,s=$("#bucketTabs div").attr("id");return e==s&&(t=!0),t}function goToChapter(e){var t=parseInt(currentStatus.chapter,10),s=currentLocation.id,i=!1,a=assets.get(currentLocation.name),n=a.chaptersAvailable,r=n.length;if("previous"==e){if(t>parseInt(site.firstChapter,10))if(t--,"show"==site.unavailableMenuOptions&&-1==$.inArray(t.toString(),n)){for(var o,c=r-1;c>=0;c--)if(o=n[c],t>o){t=o,i=!0;break}}else i=!0}else if("next"==e&&t<parseInt(site.lastChapter,10))if(t++,"show"==site.unavailableMenuOptions&&-1==$.inArray(t.toString(),n)){for(var o,c=0;r>c;c++)if(o=n[c],o>t){t=o,i=!0;break}}else i=!0;i&&(s=s.replace(/\d+(:\w+)$/,t.toString()+"$1"),currentStatus.resetTabStatus(),controller.showLocation(s))}function showComingSoon(e,t){var s=allSites.templates.coming_soon,i="",a={};i+="Content for "+t.title+" is",a.message=i,pageStr=replaceVars(s,a),$(e).html(pageStr)}function showNotAvailable(e,t){var s='<div class="missing">'+t.title+" Content Not Available";"chapter"==t.scope&&(s+=" for This "+site.labels.chapterSingular),s+=".</div>",$(e).html(s)}function checkPageStatus(e,t){var s="ok";if("cross-domain"==getUrlType(e))return s;try{$.ajax({url:e,async:!1,complete:function(e,i){"success"!=i?assets.get(t)["protected"]&&"404"!=e.status&&"0"!=e.status||(s="not found"):null!==(matchArray=e.responseText.match(allSites.loginPattern))?s="login":null!==(matchArray=e.responseText.match(allSites.notFoundPattern))&&(s="not found")}})}catch(i){s="login"}return s}function makeOpenInTab(e){$(e+" a").click(function(){var e=$(this).attr("href");return loadIntoTab(e),!1})}function loadIntoTab(e){$assetTabs.tabs("option","disabled",[]),fileLoader.loadFileIntoPage("div#tabsAsset",currentLocation,e),$assetTabs.tabs("select",1)}function initAssetTabs(){$assetTabs.tabs("select",0),$assetTabs.tabs("option","disabled",[1])}function setChapterViewButtons(){"single"==currentStatus.chapterView?($(".allChapters").removeClass("selected"),$(".thisChapter").addClass("selected")):"all"==currentStatus.chapterView&&($(".thisChapter").removeClass("selected"),$(".allChapters").addClass("selected")),"chapter"==currentLocation.scope?$(".chapterView").removeClass("inactive"):$(".chapterView").addClass("inactive")}function getChapterTitle(e){var t="",s=0;return e&&(s=parseInt(e,10)-site.startChapterNumber,t=site.chapterTitles[s]),t}function makeChapterStr(e){var t="",s='<div class="breadcrumbChapter">';return e&&(s+=e),"home"==currentLocation.type?t=s+'<span class="chapNum">Home Page</span></div>':"book"==currentLocation.scope?t=s+'<span class="chapNum">Course Resource</span></div>':currentLocation.chapter&&(t=site.showChapterNumbers?s+'<span class="chapNum">'+currentStatus.chapter+'. </span><span class="chapTitle">'+getChapterTitle(currentStatus.chapter)+"</span></div>":s+'<span class="chapNum">'+getChapterTitle(currentStatus.chapter)+"</span></div>"),t}function initSite(){document.title=site.title,$assetTabs=$("#assetTabs").tabs({show:function(e,t){var s=t.panel.id,i=s+"-iframe";isFirstTab(s)||sizeIframe(i)},disabled:[1]})}function initContentPage(e,t){var s="a.popup";t.linkStyle&&0===t.linkStyle.indexOf("popup")&&(s="a"),$(e+" "+s).click(function(){var e=$(this).attr("class"),t=$(this).attr("href");return openPopup(t,e),!1})}function loadPopup(){0===currentStatus.chapterMenu&&($("#backgroundPopup").fadeIn("slow"),$("#chapterMenu").fadeIn("slow"),currentStatus.chapterMenu=1)}function disablePopup(){1==currentStatus.chapterMenu&&($("#backgroundPopup").fadeOut("slow"),$("#chapterMenu").fadeOut("slow"),currentStatus.chapterMenu=0)}function update4ltrStylesheet(){function e(){document.styleSheets[2]&&(t(),clearInterval(s))}function t(){var e,t=/#(currentChapter|previousChapter|nextChapter|selectChapter|sideMenuWrapper|chapterView|sideMenu)/g,s=document.styleSheets[2],i="",a=[],n="",r=/background-color: rgb\(\d+, \d+, \d+\) ! important;/,o=/background-color: (#\w+)! important/i;if(s.cssRules){e=s.cssRules;for(var c=0,l=e.length,u="";l>c;c++)u=e[c].cssText.replace(".selectChapter",".popupMenu","g"),u=u.replace(t,".$1"),u=u.replace(".sideMenuWrapper ",""),r.test(e[c].style.cssText)&&(u="a.loginBtn, "+u),e[c].cssText=u,s.deleteRule(c),s.insertRule(u,c)}else s.cssText&&(null!==(a=s.cssText.match(o))&&(n=a[1]),i=s.cssText.replace(".selectChapter",".popupMenu","g"),i=i.replace(t,".$1"),i=i.replace(".sideMenuWrapper ",""),i+="a.loginBtn { background-color: "+n+" !important };",document.styleSheets[2].cssText=i)}var s=setInterval(e,300)}function isBoolean(e){return"boolean"==typeof e?!0:!1}function busy(){$("html").addClass("busy"),$("#loading").show()}function notbusy(){$("html").removeClass("busy"),$("#loading").hide()}function strToBoolean(e){switch(e){case"true":return!0;case"false":return!1}}function isObject(e){return"object"!=typeof e||$.isArray(e)?!1:!0}function copyToObject(e,t,s){for(var i in e)s&&typeof e[i]!=s||(t[i]=e[i])}function removeFilename(e,t){if(!e)return"";var s=e.replace(/\/[^\/#]*(#.*)?$/,"");return 2!=arguments.length||t||(s+="/"),s}function removeExtension(e){if(!e)return"";var t=e.replace(/\.[^\.]*$/,"");return t}function removeHash(e){if(!e)return"";var t=e.replace(/#.*$/,"");return t}function getExtension(e){if(!e)return"";var t=[],s="";return null!==(t=e.match(/\.([^\.\/]*)$/))&&(s=t[1]),s.toLowerCase()}function getHostname(e){var t="",s=[];return null!==(s=e.match(/^http:\/\/([^\/]+)/))&&(t=s[1]),t}function removeTrailingSlash(e){return e.replace(/\/+$/,"")}function makePath(e,t){var s="",i="";if(e)for(var a=0;a<e.length;a++)i=e[a],i&&(a>0&&i.replace(/^\/+/,""),"/"!=i.charAt(i.length-1)&&(i+="/"),s+=i);return t&&(i&&(t=t.replace(/^\/+/,"")),s+=t),s}function getValueFromQuery(e,t){var s=[],i="",a=new RegExp("[\\?&]"+e+"=([^&]+)");return null!==(s=t.match(a))&&(i=s[1]),i}function extractBody(e){return e=e.replace(/^[\s\S]*?<body[^>]*>/i,""),e=e.replace(/<\/body[^>]*>[\s\S]*$/i,"")}function padNum(e,t){if(!e)return"";for(e=e.toString();e.length<t;)e="0"+e;return e}function getFilename(e){if(!e)return"";var t;t=e.lastIndexOf("/"),-1==t&&(t=e.lastIndexOf("\\"));var s=e.substring(t+1);return s}function isUrl(e){var t=/^http:\/\//;return t.test(e)?!0:!1}function makeHead(e){return"<p><b>"+e+"</b></p>"}function makeBold(e){return"<b>"+e+"</b>"}function makeLink(e,t,s){var i="",a="";return s&&(i=' class="'+s+'"'),a='<a href="'+t+'"'+i+">"+e+"</a>"}function makeListWithCommas(e){for(var t=e.length-1,s=e.length,i="",a=0;s>a;a++)a>0&&(s>2&&(i+=","),i+=a==t?" and ":" "),i+=e[a];return i}function numerical(e,t){return e=parseInt(e,10),t=parseInt(t,10),t>e?-1:e>t?1:0}function showHideBook(){var e="",t=currentLocation.resourceGroup,s=(resourceCenter.getIndex(t),site.siteFiles.homePageBaseFilename+".html");"resource_center"==site.type&&(e=site.siteFiles.homePageBaseFilename+".html","true"==site.showBook?"home"!=currentLocation.type?($("#homePageImg").hide(),$("#homeIntro").hide(),$("#bookInfoWrapper").show(),$("#homeImageBtm").show(),fileLoader.loadFileIntoPage("#bookDesc","",e),$("#bookTitle").html(site.title),$("#bookSubtitle").html("<strong>"+site.subtitle+"</strong> "+site.edition),$("#edition").html(""),$("#author").html("by "+site.author)):($("#homePageImg").show(),$("#homeIntro").show(),$("#bookInfoWrapper").hide(),$("#homeImageBtm").hide(),fileLoader.loadFileIntoPage("#homeIntro","",s)):($("#homeIntro").show(),$("#bookInfoWrapper").hide(),$("#homeImageBtm").hide(),fileLoader.loadFileIntoPage("#homeIntro","",s)))}var ConstantValues,ErrorHandler,Update,Clear,Show,AllSites,Site,Buckets,Assets,ResourceCenter,ContentLocation,allSites=new AllSites,site=new Site,buckets=new Buckets,assets=new Assets,resourceCenter=new ResourceCenter,currentLocation=new ContentLocation("current"),tempLocation=new ContentLocation("temp"),currentStatus=new Status,controller=new Controller,view=new View,fileLoader=new FileLoader,flashManager=new FlashManager,errorHandler=new ErrorHandler,ajaxResults=new AjaxResults,constants=new ConstantValues,tracker;$.ajaxSetup({}),$(document).ready(function(){var e="",t=getLocationId();if(currentLocation.update(t),"all sites"!=currentLocation.type){if(site.getAllSitesData(),fileLoader.loadSiteDefinition(),$("html").removeClass("busy"),site.update(),loadStylesheet(site.engineFiles.stylesheet),"4ltr"==site.type&&(loadStylesheet(site.siteFiles.stylesheet4ltr),update4ltrStylesheet()),errorHandler.show(),buckets.update(),currentStatus.checkAuthentication(),currentStatus.authenticated&&fileLoader.getSsoUrls(),fileLoader.loadScript(site.engineFiles.glossary),glossary.loadContent(),loadTracker(),tracker=new Tracker,loadCustomStylesheet(),e=site.engineDirs.templates,!currentStatus.shell&&site.siteFiles.standaloneStyles){var s=document.createElement("link");s.type="text/css",s.rel="stylesheet",s.href=site.siteFiles.standaloneStyles,s.media="screen",s.title="dynamicLoadedSheet",document.getElementsByTagName("head")[0].appendChild(s)}e=currentStatus.shell?makePath([e],site.engineFiles.shellTemplate):makePath([e],"standalone.html")}else e=makePath([allSites.engineDirs.templates],"report.html"),loadStylesheet(allSites.engineFiles.reportStylesheet),allSitesIndex=new AllSitesIndex;$.ajax({url:e,async:!1,success:function(e){e=replaceVars(e,currentLocation),$("body").html(e),$(document).ready(function(){currentStatus.shell&&view.init(),initSite(),controller.showLocation(t)})},error:function(){alert("Couldn't load template file "+e)}})});